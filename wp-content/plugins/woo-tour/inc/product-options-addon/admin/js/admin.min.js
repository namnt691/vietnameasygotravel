!function(a){"use strict";a(document).ready(function(){function e(i){i.length&&i.find(".cmb-group-title").each(function(){var e,o=a(this),t=o.next().find('[id$="_name"]').val();t||(t=i.find("[data-grouptitle]").data("grouptitle"))&&(e=o.parents("[data-iterator]").data("iterator"),t=t.replace("{#}",e+1)),t&&o.text(t)})}jQuery("#exwo_addition_options").on("cmb2_add_row cmb2_shift_rows_complete",e).on("keyup",function(e){var o=a(e.target),t="name";-1!==e.target.id.indexOf(t,e.target.id.length-t.length)&&o.parents(".cmb-row.cmb-repeatable-grouping").find(".cmb-group-title").text(o.val())}),e(jQuery("#exwo_addition_options")),jQuery("body").on("click",function(){e(jQuery("#exwo_addition_options"))}),0<jQuery("#cmb2-metabox-exwo_addition_options.cmb2-metabox .extype-option select").length&&(jQuery("#cmb2-metabox-exwo_addition_options.cmb2-metabox .extype-option select").each(function(){var e=a(this),o=e.val(),o=""!=o?"ex-otype-"+o:"";""==e.closest(".exwo-general").find(".exwo-op-enbimg select").val()&&(o+=" ex-hide-enbimg"),""!=o&&e.closest(".postbox.cmb-repeatable-grouping").addClass(o)}),jQuery("body").on("change","#cmb2-metabox-exwo_addition_options.cmb2-metabox .extype-option select",function(){var e=a(this),o=e.val();e.closest(".postbox").find('.exwo-options input[type="checkbox"]').prop("checked",!1),e.closest(".postbox.cmb-repeatable-grouping").removeClass(function(e,o){return(o.match(/(^|\s)ex-otype\S+/g)||[]).join(" ")}),""!=o&&e.closest(".postbox.cmb-repeatable-grouping").addClass("ex-otype-"+o)}),jQuery("body").on("change","#cmb2-metabox-exwo_addition_options.cmb2-metabox .exwo-op-enbimg select",function(){var e=a(this);""!=e.val()?e.closest(".postbox.cmb-repeatable-grouping").removeClass("ex-hide-enbimg"):e.closest(".postbox.cmb-repeatable-grouping").addClass("ex-hide-enbimg")})),a("body").on("change",'.cmb-type-price-options .exwo-options input[type="checkbox"]',function(){var e=a(this),o=e.closest(".cmb-type-price-options").find('.exwo-options.exwo-def-option input[type="checkbox"]:checked').length;(e.closest(".postbox.ex-otype-radio").length||e.closest(".postbox.ex-otype-select").length)&&1<o&&(e.closest(".cmb-type-price-options").find('.exwo-options.exwo-def-option input[type="checkbox"]').prop("checked",!1),this.checked=!0,event.preventDefault())}),a("body").on("click",".exwo-gr-option a:not(.exwo-copypre):not(.exwo-copy):not(.exwo-paste)",function(){var e=a(this);e.closest(".cmb-field-list").find(".exwo-gr-option a").removeClass("current"),e.addClass("current");var o=e.attr("data-remove"),t=e.attr("data-add");e.closest(".cmb-field-list").find(o).fadeOut(),e.closest(".cmb-field-list").find(t).fadeIn()}),jQuery("body").on("change",".exwo-options.exwo-val-option select",function(){jQuery(this).next().val(jQuery(this).val())}),jQuery("#exwo_addition_options").on("click",".exwo-copypre",function(){var e=a(this).closest(".cmb-repeatable-grouping"),o=e.prev();e.find(".exwo-op-name .cmb-td input").val(o.find(".exwo-op-name .cmb-td input").val()),e.find(".exwo-op-type .cmb-td select").val(o.find(".exwo-op-type .cmb-td select").val()).trigger("change"),e.find(".exwo-op-enbimg .cmb-td select").val(o.find(".exwo-op-enbimg .cmb-td select").val()).trigger("change"),e.find(".exwo-op-rq .cmb-td select").val(o.find(".exwo-op-rq .cmb-td select").val()),e.find(".exwo-op-min .cmb-td input").val(o.find(".exwo-op-min .cmb-td input").val()),e.find(".exwo-op-max .cmb-td input").val(o.find(".exwo-op-max .cmb-td input").val());var t=e.find(".exwo-op-name .cmb-td input").attr("name").split("][")[0].match(/\d+/),i=o.find(".exwo-op-ops .cmb-td .cmb-field-list").html();e.find(".exwo-op-ops .cmb-td .cmb-field-list").html(i),e.find(".exwo-op-ops .cmb-td .cmb-field-list input:not([type=button])").each(function(){var e=(o=a(this).attr("name")).split("]["),o=o.replace(e[0],"exwo_options["+t);a(this).attr("name",o)}),e.find(".exwo-op-tpr .cmb-td select").val(o.find(".exwo-op-tpr .cmb-td select").val()),e.find(".exwo-op-pri .cmb-td input").val(o.find(".exwo-op-pri .cmb-td input").val())}),jQuery("#exwo_addition_options").on("click",".exwo-copy",function(){var e=a("<input class='exwo-ctcopy'>"),o=a(this).closest(".cmb-repeatable-grouping");a("body").append(e),e.val(o.html()).select(),document.execCommand("copy"),e.remove()}),jQuery("#exwo_addition_options").on("click",".exwo-paste",function(e){a(this).find(".exwo-ctpaste").fadeIn(),a(this).find(".exwo-paste-tt").css("display","block"),a(this).find(".exwo-paste-mes").css("display","none")}),jQuery("#exwo_addition_options").length&&jQuery(document).on("click",function(e){0===a(e.target).closest(".exwo-paste").length&&a(".exwo-ctpaste").fadeOut(),0===a(e.target).closest(".exwo-val-option").length&&a(".exwo-list-value").fadeOut()}),a("body").on("paste","#exwo_addition_options .exwo-ctpaste",function(){var i=a(this),n=i.closest(".cmb-repeatable-grouping");setTimeout(function(){var e=i.val(),e=a("<div>"+e+"<div>");n.find(".exwo-op-name .cmb-td input").val(e.find(".exwo-op-name .cmb-td input").val()),n.find(".exwo-op-type .cmb-td select").val(e.find(".exwo-op-type .cmb-td select").val()).trigger("change"),n.find(".exwo-op-rq .cmb-td select").val(e.find(".exwo-op-rq .cmb-td select").val()),n.find(".exwo-op-min .cmb-td input").val(e.find(".exwo-op-min .cmb-td input").val()),n.find(".exwo-op-max .cmb-td input").val(e.find(".exwo-op-max .cmb-td input").val());var t=n.find(".exwo-op-name .cmb-td input").attr("name").split("][")[0].match(/\d+/),o=e.find(".exwo-op-ops .cmb-td .cmb-field-list").html();n.find(".exwo-op-ops .cmb-td .cmb-field-list").html(o),n.find(".exwo-op-ops .cmb-td .cmb-field-list input:not([type=button])").each(function(){var e=(o=a(this).attr("name")).split("]["),o=o.replace(e[0],"exwo_options["+t);a(this).attr("name",o)}),n.find(".exwo-op-tpr .cmb-td select").val(e.find(".exwo-op-tpr .cmb-td select").val()),n.find(".exwo-op-pri .cmb-td input").val(e.find(".exwo-op-pri .cmb-td input").val()),i.closest(".exwo-paste").find(".exwo-paste-tt").css("display","none"),i.closest(".exwo-paste").find(".exwo-paste-mes").css("display","block"),i.val("").fadeOut()},100)}),jQuery("#exwo_addition_options").on("click",".cmb-add-row button",function(e){a(this).closest(".cmb-row").prev().find(".exwo-paste-mes").css("display","none"),a(this).closest(".cmb-row").prev().find(".exwo-paste-tt").css("display","block"),a(this).closest(".cmb-row").prev().find(".exwo-copy").addClass("disabled").css("opacity","0.5"),a(this).closest(".cmb-row").prev().find(".exwo-con-logic .exwo-stcon-logic .exwo-options.exwo-type_op-option select option").prop("disabled",!1)}),jQuery("#exwo_addition_options").on("click",".exwo-copy.disabled",function(e){alert(a(this).attr("data-textdis"))}),jQuery("#exwo_addition_options").on("click",".exwo-con-logic .exwo-val-option",function(e){var o=a(this),t=o.closest(".cmb-td").find(".exwo-type_op-option select").val();"varia"==t?(o.find(".exwo-list-value li:not(.exwo-variation)").css("display","none"),o.find(".exwo-list-value li.exwo-variation").css("display","block")):(o.find(".exwo-list-value li").css("display","none"),o.find(".exwo-list-value li."+t).css("display","block")),o.find(".exwo-list-value li").hasClass(t)?o.find("input").attr("readonly",!0):o.find("input").attr("readonly",!1),o.find(".exwo-list-value").fadeIn()}),jQuery("#exwo_addition_options").on("click",".exwo-con-logic .exwo-list-value li",function(e){var o=a(this);e.stopPropagation(),o.closest(".exwo-val-option").find("li").removeClass("exwo-current"),o.addClass("exwo-current"),o.closest(".exwo-val-option").find(".exwo-conval").val(o.attr("data-val")),a(".exwo-list-value").fadeOut()}),a("body").on("click",".exwf-collapse .cmb-type-title",function(e){var o=a(this);a(o).next(".exwf-collapse-con").slideToggle(200),o.hasClass("exwf-active")?o.removeClass("exwf-active"):o.addClass("exwf-active")})})}(jQuery);